"use strict";(self.webpackChunkelfsquad=self.webpackChunkelfsquad||[]).push([["78484"],{23460:function(e,n,r){r.r(n),r.d(n,{frontMatter:()=>a,default:()=>h,toc:()=>o,metadata:()=>s,assets:()=>d,contentTitle:()=>l});var s=JSON.parse('{"id":"archer/archer-ml-python","title":"Python Scripting","description":"Python scripting allows you to extend your configuration models with custom logic, external API integrations, and dynamic behavior. Scripts are executed server-side in a sandboxed Python environment and can be used across four different contexts: value expressions, model scripts, text expressions, and dynamic groups.","source":"@site/docs/archer/archer-ml-python.md","sourceDirName":"archer","slug":"/archer/python","permalink":"/docs/archer/python","draft":false,"unlisted":false,"editUrl":"https://github.com/elfsquad/docs/edit/main/docs/archer/archer-ml-python.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"title":"Python Scripting","sidebar_position":2,"sidebar_label":"Python scripting","slug":"./python"},"sidebar":"archerSidebar","previous":{"title":"Overview","permalink":"/docs/archer/"}}'),i=r(85893),t=r(50065);let a={title:"Python Scripting",sidebar_position:2,sidebar_label:"Python scripting",slug:"./python"},l=void 0,d={},o=[{value:"How it works",id:"how-it-works",level:2},{value:"Script structure",id:"script-structure",level:2},{value:"The <code>invoke</code> function",id:"the-invoke-function",level:3},{value:"Accessing variables",id:"accessing-variables",level:3},{value:"Child variables",id:"child-variables",level:3},{value:"Multilevel children",id:"multilevel-children",level:3},{value:"Value expressions",id:"value-expressions",level:2},{value:"Pure functions",id:"pure-functions",level:3},{value:"Model scripts",id:"model-scripts",level:2},{value:"The <code>assign_property</code> function",id:"the-assign_property-function",level:3},{value:"Logging",id:"logging",level:3},{value:"Text expressions",id:"text-expressions",level:2},{value:"Find and replace expressions",id:"find-and-replace-expressions",level:3},{value:"Dynamic groups",id:"dynamic-groups",level:2},{value:"Return format",id:"return-format",level:3},{value:"Accessing configuration state",id:"accessing-configuration-state",level:3},{value:"Environment variables",id:"environment-variables",level:2},{value:"Available libraries",id:"available-libraries",level:2},{value:"Examples",id:"examples",level:2},{value:"Fetching prices from an external API",id:"fetching-prices-from-an-external-api",level:3},{value:"Calculating a weighted total",id:"calculating-a-weighted-total",level:3},{value:"Generating options from a database",id:"generating-options-from-a-database",level:3},{value:"Conditional text generation",id:"conditional-text-generation",level:3},{value:"Linear optimization with PuLP",id:"linear-optimization-with-pulp",level:3}];function c(e){let n={code:"code",em:"em",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,t.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Python scripting allows you to extend your configuration models with custom logic, external API integrations, and dynamic behavior. Scripts are executed server-side in a sandboxed Python environment and can be used across four different contexts: value expressions, model scripts, text expressions, and dynamic groups."}),"\n",(0,i.jsx)(n.h2,{id:"how-it-works",children:"How it works"}),"\n",(0,i.jsxs)(n.p,{children:["Every Python script must define an ",(0,i.jsx)(n.code,{children:"invoke"})," function that accepts a single ",(0,i.jsx)(n.code,{children:"args"})," parameter. This function is called by the runtime, and ",(0,i.jsx)(n.code,{children:"args"})," is a dictionary containing the variables you've configured in the expression editor."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def invoke(args):\n    return args['Width']['value'] * args['Height']['value']\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"args"})," dictionary keys correspond to the ",(0,i.jsx)(n.strong,{children:"tags"})," you assign to variables in the expression editor. Each variable is a dictionary containing properties like ",(0,i.jsx)(n.code,{children:"value"}),", ",(0,i.jsx)(n.code,{children:"selected"}),", and any custom feature properties."]}),"\n",(0,i.jsx)(n.h2,{id:"script-structure",children:"Script structure"}),"\n",(0,i.jsxs)(n.h3,{id:"the-invoke-function",children:["The ",(0,i.jsx)(n.code,{children:"invoke"})," function"]}),"\n",(0,i.jsxs)(n.p,{children:["Every script must define an ",(0,i.jsx)(n.code,{children:"invoke"})," function. This is the entry point that receives the configured variables and returns a result."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def invoke(args):\n    # args is a dictionary of variables\n    # Return a value appropriate for the expression type\n    return result\n"})}),"\n",(0,i.jsx)(n.p,{children:"The return type depends on where the script is used:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Expression type"}),(0,i.jsx)(n.th,{children:"Expected return type"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Value expression"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"float"})," or ",(0,i.jsx)(n.code,{children:"int"})," (numeric)"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Text expression"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"str"})," (string)"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Dynamic group"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"list"})," of dictionaries"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Model script"}),(0,i.jsx)(n.td,{children:"Any (return value is ignored)"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"accessing-variables",children:"Accessing variables"}),"\n",(0,i.jsx)(n.p,{children:"Variables are passed as dictionaries with the following properties:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def invoke(args):\n    feature = args['MyFeature']\n\n    feature['value']       # Numeric value (decimal)\n    feature['selected']    # Boolean - whether the feature is selected\n    feature['textValue']   # Text value (string or None)\n    feature['id']          # Node ID (GUID string)\n    feature['featureId']   # Feature ID (GUID string)\n    feature['code']        # Article code\n    feature['name']        # Feature name\n"})}),"\n",(0,i.jsx)(n.p,{children:"Custom feature properties are also included by name:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def invoke(args):\n    feature = args['MyFeature']\n    weight = feature['Weight']      # Numeric property\n    color = feature['ColorName']    # Text property\n"})}),"\n",(0,i.jsx)(n.h3,{id:"child-variables",children:"Child variables"}),"\n",(0,i.jsxs)(n.p,{children:["When a variable is configured with ",(0,i.jsx)(n.strong,{children:"Children"})," enabled, it becomes a list of dictionaries instead of a single dictionary:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def invoke(args):\n    children = args['Options']  # List of child feature dictionaries\n\n    total = 0\n    for child in children:\n        if child['selected']:\n            total += child['value']\n    return total\n"})}),"\n",(0,i.jsx)(n.h3,{id:"multilevel-children",children:"Multilevel children"}),"\n",(0,i.jsxs)(n.p,{children:["When ",(0,i.jsx)(n.strong,{children:"Multilevel"})," is enabled (model scripts only), child variables include a ",(0,i.jsx)(n.code,{children:"_children"})," property for recursive traversal:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def invoke(args):\n    def sum_tree(node):\n        total = node['value']\n        for child in node.get('_children', []):\n            total += sum_tree(child)\n        return total\n\n    return sum_tree(args['Root'])\n"})}),"\n",(0,i.jsx)(n.h2,{id:"value-expressions",children:"Value expressions"}),"\n",(0,i.jsx)(n.p,{children:"Value expressions compute a numeric value for a feature based on other features in the model. The script must return a number."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def invoke(args):\n    width = args['Width']['value']\n    height = args['Height']['value']\n    return width * height\n"})}),"\n",(0,i.jsx)(n.p,{children:"The returned value is used as the derived value for the feature the expression is attached to. Value expressions are evaluated during the solving process whenever referenced variables change."}),"\n",(0,i.jsx)(n.h3,{id:"pure-functions",children:"Pure functions"}),"\n",(0,i.jsxs)(n.p,{children:["Value expressions can be marked as ",(0,i.jsx)(n.strong,{children:"pure functions"})," in the expression editor. A pure function always returns the same result for the same inputs, which allows the system to cache results and improve performance. Mark your expression as pure if it doesn't depend on external state (no API calls, no randomness)."]}),"\n",(0,i.jsx)(n.h2,{id:"model-scripts",children:"Model scripts"}),"\n",(0,i.jsxs)(n.p,{children:["Model scripts run during the solving process and can modify feature values, text values, and image values using the ",(0,i.jsx)(n.code,{children:"assign_property"})," function. Unlike value expressions, model scripts don't return a meaningful value - they operate through side effects."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def invoke(args):\n    quantity = args['Quantity']['value']\n    price_per_unit = args['PricePerUnit']['value']\n\n    total = quantity * price_per_unit\n\n    assign_property(args['TotalPrice'], 'value', total)\n    assign_property(args['Summary'], 'textValue', f'Total: \u20AC{total:.2f}')\n"})}),"\n",(0,i.jsxs)(n.h3,{id:"the-assign_property-function",children:["The ",(0,i.jsx)(n.code,{children:"assign_property"})," function"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"assign_property"})," is a built-in function available in all Python scripts. It issues a command to update a feature's property."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"assign_property(variable, property_name, value)\n"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Parameter"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"variable"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"dict"})}),(0,i.jsxs)(n.td,{children:["A variable from ",(0,i.jsx)(n.code,{children:"args"})," (must contain an ",(0,i.jsx)(n.code,{children:"id"})," field)"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"property_name"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"str"})}),(0,i.jsx)(n.td,{children:"The property to set"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"value"})}),(0,i.jsx)(n.td,{children:"any"}),(0,i.jsx)(n.td,{children:"The value to assign"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Built-in property names:"})}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Property"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"value"})}),(0,i.jsx)(n.td,{children:"Sets the numeric value of the feature"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"textValue"})}),(0,i.jsx)(n.td,{children:"Sets the text value of the feature"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"imageValue"})}),(0,i.jsx)(n.td,{children:"Sets the image URL of the feature"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:"You can also assign custom properties by name. These become available to other expressions that reference the feature:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def invoke(args):\n    data = fetch_external_data()\n    assign_property(args['Feature'], 'ExternalWeight', data['weight'])\n    assign_property(args['Feature'], 'ExternalPrice', data['price'])\n"})}),"\n",(0,i.jsx)(n.h3,{id:"logging",children:"Logging"}),"\n",(0,i.jsxs)(n.p,{children:["Use ",(0,i.jsx)(n.code,{children:"print()"})," to send log messages to the configurator. Messages printed to stdout appear as info-level logs, and messages printed to stderr appear as error-level logs."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import sys\n\ndef invoke(args):\n    print('Processing configuration...')           # Info level\n    print('Something went wrong', file=sys.stderr) # Error level\n"})}),"\n",(0,i.jsx)(n.h2,{id:"text-expressions",children:"Text expressions"}),"\n",(0,i.jsx)(n.p,{children:"Text expressions generate dynamic text for features. The script must return a string."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def invoke(args):\n    color = args['Color']['name']\n    size = args['Size']['value']\n    return f'{color} - Size {size}'\n"})}),"\n",(0,i.jsx)(n.p,{children:"Text expressions are evaluated after the solver completes, in dependency order. If one text expression references a variable whose text value is set by another text expression, the referenced expression is evaluated first."}),"\n",(0,i.jsx)(n.h3,{id:"find-and-replace-expressions",children:"Find and replace expressions"}),"\n",(0,i.jsxs)(n.p,{children:["In addition to Python, text expressions support a simpler ",(0,i.jsx)(n.strong,{children:"find and replace"})," syntax using ",(0,i.jsx)(n.code,{children:"@{expression}"})," placeholders:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"The selected color is @{Color} with size @{Size.Value * 2}\n"})}),"\n",(0,i.jsx)(n.p,{children:"This syntax uses dynamic LINQ expressions and is useful for simple text formatting without writing a full Python script."}),"\n",(0,i.jsx)(n.h2,{id:"dynamic-groups",children:"Dynamic groups"}),"\n",(0,i.jsx)(n.p,{children:"Dynamic groups use Python scripts to generate features dynamically, often based on external data sources. The script must return a list of dictionaries, where each dictionary represents a feature to create."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import requests\n\ndef invoke(args):\n    response = requests.get('https://api.example.com/products')\n    products = response.json()\n\n    return [\n        {\n            'id': product['sku'],\n            'name': product['name'],\n            'price': product['price'],\n            'description': product['description']\n        }\n        for product in products\n    ]\n"})}),"\n",(0,i.jsx)(n.h3,{id:"return-format",children:"Return format"}),"\n",(0,i.jsx)(n.p,{children:"Each dictionary in the returned list must include:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Field"}),(0,i.jsx)(n.th,{children:"Required"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"id"})}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"str"})}),(0,i.jsx)(n.td,{children:"Unique identifier for the feature"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"name"})}),(0,i.jsx)(n.td,{children:"Yes"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"str"})}),(0,i.jsx)(n.td,{children:"Display name of the feature"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.em,{children:"(other fields)"})}),(0,i.jsx)(n.td,{children:"No"}),(0,i.jsx)(n.td,{children:"varies"}),(0,i.jsx)(n.td,{children:"Become feature properties"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:"Property types are inferred from the value type:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Value type"}),(0,i.jsx)(n.th,{children:"Feature property type"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"str"})}),(0,i.jsx)(n.td,{children:"Text property"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"int"})," or ",(0,i.jsx)(n.code,{children:"float"})]}),(0,i.jsx)(n.td,{children:"Input (numeric) property"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.code,{children:"dict"})," with ",(0,i.jsx)(n.code,{children:"id"})," field"]}),(0,i.jsx)(n.td,{children:"Associated feature property"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"accessing-configuration-state",children:"Accessing configuration state"}),"\n",(0,i.jsxs)(n.p,{children:["Dynamic group scripts receive the same variable format as other scripts, plus a ",(0,i.jsx)(n.code,{children:"CONFIGURATION_ID"})," constant:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def invoke(args):\n    config_id = args['CONFIGURATION_ID']\n    selected_category = args['Category']\n\n    if selected_category['selected']:\n        return fetch_products(selected_category['code'])\n    return []\n"})}),"\n",(0,i.jsx)(n.h2,{id:"environment-variables",children:"Environment variables"}),"\n",(0,i.jsx)(n.p,{children:"Scripts can access environment variables (secrets) that are configured in the Elfsquad Management System. These are useful for storing API keys and other sensitive data."}),"\n",(0,i.jsxs)(n.p,{children:["Environment variables are injected into ",(0,i.jsx)(n.code,{children:"os.environ"})," before script execution:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import os\nimport requests\n\ndef invoke(args):\n    api_key = os.environ.get('API_KEY')\n    response = requests.get(\n        'https://api.example.com/data',\n        headers={'Authorization': f'Bearer {api_key}'}\n    )\n    return response.json()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"available-libraries",children:"Available libraries"}),"\n",(0,i.jsx)(n.p,{children:"The Python runtime includes the following libraries in addition to the Python standard library:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Library"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"requests"})}),(0,i.jsx)(n.td,{children:"HTTP client for making API calls"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"numpy"})}),(0,i.jsx)(n.td,{children:"Numerical computing"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"scipy"})}),(0,i.jsx)(n.td,{children:"Scientific computing"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"pandas"})}),(0,i.jsx)(n.td,{children:"Data analysis and manipulation"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"pulp"})}),(0,i.jsx)(n.td,{children:"Linear and integer programming"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"matplotlib"})}),(0,i.jsx)(n.td,{children:"Data visualization"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:"You can import any of these in your scripts:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import numpy as np\nimport pandas as pd\n\ndef invoke(args):\n    values = [child['value'] for child in args['Items'] if child['selected']]\n    return float(np.mean(values)) if values else 0.0\n"})}),"\n",(0,i.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,i.jsx)(n.h3,{id:"fetching-prices-from-an-external-api",children:"Fetching prices from an external API"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import os\nimport requests\n\ndef invoke(args):\n    api_url = os.environ.get('PRICING_API_URL')\n    product_code = args['Product']['code']\n\n    response = requests.get(f'{api_url}/prices/{product_code}')\n    data = response.json()\n\n    assign_property(args['Product'], 'value', data['price'])\n    assign_property(args['Product'], 'textValue', data['currency'])\n"})}),"\n",(0,i.jsx)(n.h3,{id:"calculating-a-weighted-total",children:"Calculating a weighted total"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def invoke(args):\n    total = 0\n    for option in args['Options']:\n        if option['selected']:\n            total += option['value'] * option['Weight']\n    return total\n"})}),"\n",(0,i.jsx)(n.h3,{id:"generating-options-from-a-database",children:"Generating options from a database"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import os\nimport requests\n\ndef invoke(args):\n    api_key = os.environ.get('DB_API_KEY')\n    category = args['Category']['code']\n\n    response = requests.get(\n        f'https://api.example.com/items?category={category}',\n        headers={'X-Api-Key': api_key}\n    )\n\n    return [\n        {\n            'id': item['id'],\n            'name': item['name'],\n            'price': item['unit_price'],\n            'lead_time': item['lead_time_days']\n        }\n        for item in response.json()\n    ]\n"})}),"\n",(0,i.jsx)(n.h3,{id:"conditional-text-generation",children:"Conditional text generation"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"def invoke(args):\n    parts = []\n    for option in args['SelectedOptions']:\n        if option['selected']:\n            parts.append(f\"{option['name']} (x{option['value']:.0f})\")\n\n    if not parts:\n        return 'No options selected'\n\n    return ', '.join(parts)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"linear-optimization-with-pulp",children:"Linear optimization with PuLP"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import pulp\n\ndef invoke(args):\n    items = args['Items']\n\n    prob = pulp.LpProblem('Optimize', pulp.LpMinimize)\n    quantities = {\n        i: pulp.LpVariable(f'q_{i}', lowBound=0)\n        for i in range(len(items))\n    }\n\n    # Minimize total cost\n    prob += pulp.lpSum(\n        quantities[i] * items[i]['UnitCost']\n        for i in range(len(items))\n    )\n\n    # Meet minimum quantity\n    prob += pulp.lpSum(quantities.values()) >= args['MinQuantity']['value']\n\n    prob.solve(pulp.PULP_CBC_CMD(msg=0))\n\n    for i, item in enumerate(items):\n        assign_property(item, 'value', quantities[i].varValue or 0)\n\n    return pulp.value(prob.objective)\n"})})]})}function h(e={}){let{wrapper:n}={...(0,t.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);